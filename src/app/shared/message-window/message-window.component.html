<div class="flex gap-3 p-4" [class.flex-row-reverse]="message.sender === 'user'">
  <!-- Avatar -->
  <div class="flex-shrink-0">
    <div *ngIf="message.sender === 'user'"
      class="w-10 h-10 bg-gradient-to-br from-[#228B22] to-[#085308] rounded-full flex items-center justify-center shadow-lg">
      <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
      </svg>
    </div>
    <div *ngIf="message.sender === 'ai'"
      class="w-10 h-10 bg-gradient-to-br from-[#ffa978] to-amber-900 border-t-orange-600 dark:from-gray-100 dark:to-gray-200 rounded-full flex items-center justify-center shadow-lg">
      <span class="text-white dark:text-gray-800 font-bold text-sm">NB</span>
      <!-- <img src="assets/images/logo-cp.png" alt="NsemBot" class="w-5 h-5" /> -->
    </div>
  </div>

  <!-- Message Content -->
  <div class="flex-1 max-w-2xl">
    <!-- Added modern message bubble design with proper backgrounds and shadows -->
    <div
      [class]="message.sender === 'user' ?
      'bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-2xl rounded-tr-md px-4 py-3 shadow-md ml-auto max-w-lg' :
      'bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-2xl rounded-tl-md px-4 py-3 shadow-md border border-gray-200 dark:border-gray-700 max-w-lg'">

      <!-- Message header with sender and timestamp -->
      <div class="flex items-center gap-2 mb-2" [class.flex-row-reverse]="message.sender === 'user'">
        <span class="text-xs font-bold"
          [class]="message.sender === 'user' ? 'text-gray-600 dark:text-gray-400' : 'text-gray-600 dark:text-gray-400'">
          {{ message.sender === 'user' ? 'You' : 'NsemBot' }}
        </span>
        <span class="text-xs"
          [class]="message.sender === 'user' ? 'text-gray-500 dark:text-gray-500' : 'text-gray-500 dark:text-gray-500'">
          {{ message.timestamp }}
        </span>
      </div>

      <!-- Message content with improved typography -->
      <div class="text-sm leading-relaxed whitespace-pre-line" [innerHTML]="formatContent(message.content)">
      </div>
    </div>

    <!-- Improved feedback buttons with better spacing and modern styling -->
    <div *ngIf="message.sender === 'ai'" class="flex items-center gap-1 mt-3 ml-2">
      <button (click)="onFeedback('good')"
        class="flex items-center gap-1.5 px-3 py-2 text-xs font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-all duration-200 hover:shadow-sm"
        [class.bg-green-50]="message.feedback === 'good'" [class.text-green-700]="message.feedback === 'good'"
        [class.border-green-200]="message.feedback === 'good'"
        [class.dark:bg-green-900]="message.feedback === 'good'"
        [class.dark:text-green-400]="message.feedback === 'good'">
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5">
          </path>
        </svg>
        Good
      </button>

      <button (click)="onFeedback('bad')"
        class="flex items-center gap-1.5 px-3 py-2 text-xs font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-all duration-200 hover:shadow-sm"
        [class.bg-red-50]="message.feedback === 'bad'" [class.text-red-700]="message.feedback === 'bad'"
        [class.border-red-200]="message.feedback === 'bad'" [class.dark:bg-red-900]="message.feedback === 'bad'"
        [class.dark:text-red-400]="message.feedback === 'bad'">
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018c.163 0 .326.02.485.06L17 4m-7 10v2a2 2 0 002 2h.095c.5 0 .905-.405.905-.905 0-.714.211-1.412.608-2.006L17 13V4m-7 10h2m5-10h2a2 2 0 012 2v6a2 2 0 01-2 2h-2.5">
          </path>
        </svg>
        Bad
      </button>

      <button (click)="onFeedback('custom')"
        class="flex items-center gap-1.5 px-3 py-2 text-xs font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-all duration-200 hover:shadow-sm"
        [class.bg-blue-50]="message.feedback === 'custom'" [class.text-blue-700]="message.feedback === 'custom'"
        [class.border-blue-200]="message.feedback === 'custom'"
        [class.dark:bg-blue-900]="message.feedback === 'custom'"
        [class.dark:text-blue-400]="message.feedback === 'custom'">
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z">
          </path>
        </svg>
        Something like this but...
      </button>
    </div>
  </div>
</div>
